var content,description,displayDescription,displayPicture,fillNavigation,json,jumpTo,lock,nextDesc,nextImg,pictureInput,plainNumber,prevDesc,prevImg,redraw,section,sectionsCount,sectionsPointer,triggerBorder,updateCounter,xml,xmlToJson;json=void 0,section=0,content=0,description=0,sectionsCount=0,sectionsPointer=0,lock=!0,xml=void 0,this.launchIntoWindowed=function(){$("#intro").css("opacity",0),$("#intro").css("zIndex",0),$("#doku").css("opacity",1),lock=!1},this.launchIntoFullscreen=function(element){element.requestFullscreen?element.requestFullscreen():element.mozRequestFullScreen?element.mozRequestFullScreen():element.webkitRequestFullscreen?element.webkitRequestFullscreen():element.msRequestFullscreen&&element.msRequestFullscreen(),launchIntoWindowed()},$(function(){var con,i;if(json=xmlToJson(document.getElementById("data")),con=json.DOKU.ABSCHNITT,con.length>1)for(i=0;i<con.length;)con[i].INHALT.length>=1?sectionsCount+=json.DOKU.ABSCHNITT[i].INHALT.length:sectionsCount++,++i;else sectionsCount+=json.DOKU.ABSCHNITT.INHALT.length;return fillNavigation(),$("#navscroll").simplebar(),$("#description").append('<h4 id="descTitle">desctitle</h4><p id="descText">desc</p>'),$("#description").simplebar(),redraw(),document.getElementById("sN").textContent=json["@attributes"].name}),xmlToJson=function(xml){var attribute,i,item,j,nodeName,obj,old;if(obj={},1===xml.nodeType){if(xml.attributes.length>0)for(obj["@attributes"]={},j=0;j<xml.attributes.length;)attribute=xml.attributes.item(j),obj["@attributes"][attribute.nodeName]=attribute.value,j++}else 3===xml.nodeType&&(obj=xml.nodeValue);if(xml.hasChildNodes())for(i=0;i<xml.childNodes.length;)item=xml.childNodes.item(i),nodeName=item.nodeName,"undefined"==typeof obj[nodeName]?obj[nodeName]=xmlToJson(item):("undefined"==typeof obj[nodeName].push&&(old=obj[nodeName],obj[nodeName]=[],obj[nodeName].push(old)),obj[nodeName].push(xmlToJson(item))),i++;return obj},redraw=function(){displayPicture(),displayDescription(),updateCounter()},displayPicture=function(){var clone,con,game,source;con=null,con=json.DOKU.ABSCHNITT.length>1?json.DOKU.ABSCHNITT[section]:json.DOKU.ABSCHNITT,$("#title").html(con["@attributes"].titel),con=con.INHALT.length>1?con.INHALT[content]:con.INHALT,"bild"===con["@attributes"].typ?($("#contentImg").css("display","block"),document.getElementById("contentImg").src=con["@attributes"].quelle,$("#contentAnim").css("display","none"),$("#canvas").css("display","none"),$("#flashCanvas").css("display","none"),pauseAnimation()):"animation"===con["@attributes"].typ?(initialize(),playAnimation(),$("#contentAnim").css("display","block"),$("#canvas").css("display","block"),$("#contentImg").css("display","none"),$("#flashCanvas").css("display","none")):"flash"===con["@attributes"].typ&&(source=con["@attributes"].quelle,game=document.getElementById("flashCanvas"),clone=game.cloneNode(!0),clone.setAttribute("src",source),game.parentNode.replaceChild(clone,game),$("#flashCanvas").css("display","block"),$("#contentImg").css("display","none"),$("#contentAnim").css("display","none"),$("#canvas").css("display","none"),pauseAnimation()),"ein"===con["@attributes"].rahmen?($("input[name = 'borderListener']").prop("checked",!0),triggerBorder()):($("input[name = 'borderListener']").prop("checked",!1),triggerBorder())},displayDescription=function(){var con;con=null,con=json.DOKU.ABSCHNITT.length>1?json.DOKU.ABSCHNITT[section]:json.DOKU.ABSCHNITT,con=con.INHALT.length>1?con.INHALT[content]:con.INHALT,$("#descTitle").text(con["@attributes"].titel),con.DETAIL.length>1?($("#descText").text(con.DETAIL[description]["#text"]),$("#descNav").css("display","block"),$("#description").css("border-color","#7a7a80"),descNum.innerHTML=description+1+" / "+con.DETAIL.length):($("#descText").text(con.DETAIL["#text"]),$("#descNav").css("display","none"),$("#description").css("border-color","#FFF"))},nextImg=function(){sectionsPointer<sectionsCount-1&&(sectionsPointer++,content<json.DOKU.ABSCHNITT[section].INHALT.length-1?content++:(section++,content=0),description=0,redraw())},prevImg=function(){sectionsPointer>0&&(sectionsPointer--,content>0?content--:(section--,content=json.DOKU.ABSCHNITT[section].INHALT.length-1),description=0,redraw())},nextDesc=function(){description<json.DOKU.ABSCHNITT[section].INHALT[content].DETAIL.length-1&&(description++,displayDescription())},prevDesc=function(){description>0&&(description--,displayDescription())},plainNumber=function(){imgNum.value=imgNum.value.substring(0,imgNum.value.lastIndexOf("/"))},updateCounter=function(){imgNum.value=parseInt(sectionsPointer)+1+" / "+sectionsCount},pictureInput=function(){var c,i,j;if(""===imgNum.value||isNaN(imgNum.value))return 0;for(sectionsPointer=imgNum.value-1,c=0,i=0;i<json.DOKU.ABSCHNITT.length&&c!==imgNum.value;){for(j=0;j<json.DOKU.ABSCHNITT[i].INHALT.length&&c!==imgNum.value;)c!==imgNum.value&&(c++,section=i,content=j),j++;i++}imgNum.value-1>c&&(imgNum.value=c,sectionsPointer=c-1)},fillNavigation=function(){var c,i,j,string;for(string="<ul>",c=0,i=0;i<json.DOKU.ABSCHNITT.length;){if(string+="<li><details><summary>",string+=json.DOKU.ABSCHNITT[i]["@attributes"].titel,string+="</summary><ul>",json.DOKU.ABSCHNITT[i].INHALT.length>0)for(j=0;j<json.DOKU.ABSCHNITT[i].INHALT.length;)string+='<li data-link="',string+=c+":"+i+","+j+'"',string+='onclick="jumpTo(this)">',string+=json.DOKU.ABSCHNITT[i].INHALT[j]["@attributes"].titel,string+="</li>",c++,j++;else string+='<li data-link="',string+=c+":"+i+","+j+'"',string+='onclick="jumpTo(this)">',string+=json.DOKU.ABSCHNITT[i].INHALT["@attributes"].titel,string+="</li>",c++;string+="</ul></details>",i++}string+="</ul>",document.getElementById("navscroll").innerHTML=string},jumpTo=function(id){var data,jump;data=id.dataset.link.split(":"),jump=data[1].split(","),section=jump[0],content=jump[1],sectionsPointer=data[0],redraw()},triggerBorder=function(){$("#borderListener").is(":checked")?($("input[name = 'borderListener']").prop("checked",!0),$("#contentImg").css("border-color","rgb(122,122,128)"),$("#canvas").css("border-color","rgb(122,122,128)"),$("#flashCanvas").css("border-color","rgb(122,122,128)")):($("input[name = 'borderListener']").prop("checked",!1),$("#contentImg").css("border-color","#FFF"),$("#canvas").css("border-color","#FFF"),$("#flashCanvas").css("border-color","#FFF"))},$(document).keydown(function(e){lock||(37===(e.keyCode||e.which)||38===(e.keyCode||e.which)?prevImg():39!==(e.keyCode||e.which)&&40!==(e.keyCode||e.which)||nextImg()),13===(e.keyCode||e.which)&&document.getElementById("blur").focus()}),$("#navigation").on("mouseenter",function(){clearTimeout($.data(this,"timer")),$("#navigation").stop(!0,!0)}).on("mouseleave",function(){$.data(this,"timer",setTimeout(function(){$("#navTrigger").is(":checked")&&($("#navigation").stop(!0,!0).css("left","-284px"),$("#navTriggerText").toggleClass("triggered"),$("input[name = 'navTrigger']").prop("checked",!1))},1e3))}),$("input[name='navTrigger']").change(function(){$(this).is(":checked")?($("#navigation").css("left",0),$("#navTriggerText").toggleClass("triggered")):($("#navigation").css("left","-284px"),$("#navTriggerText").toggleClass("triggered"))}),function(factory){"use strict";"function"==typeof define&&define.amd?define(["jquery"],factory($,window,document,void 0)):"object"==typeof exports?factory(require("jquery"),window,document,void 0):factory(window.jQuery,window,document,void 0)}(function($,window,document,undefined){function scrollbarWidth(){var tempEl=$('<div class="scrollbar-width-tester" style="width:50px;height:50px;overflow-y:scroll;top:-200px;left:-200px;"><div style="height:100px;"></div>'),width=0,widthMinusScrollbars=0;return $("body").append(tempEl),width=$(tempEl).innerWidth(),widthMinusScrollbars=$("div",tempEl).innerWidth(),tempEl.remove(),width-widthMinusScrollbars}function SimpleBar(element,options){this.el=element,this.$el=$(element),this.$track,this.$scrollbar,this.dragOffset,this.flashTimeout,this.$contentEl=this.$el,this.$scrollContentEl=this.$el,this.scrollDirection="vert",this.scrollOffsetAttr="scrollTop",this.sizeAttr="height",this.scrollSizeAttr="scrollHeight",this.offsetAttr="top",this.options=$.extend({},SimpleBar.DEFAULTS,options),this.init()}var SCROLLBAR_WIDTH=scrollbarWidth();SimpleBar.DEFAULTS={wrapContent:!0,autoHide:!0},SimpleBar.prototype.init=function(){return 0===SCROLLBAR_WIDTH?void this.$el.css("overflow","auto"):(("horizontal"===this.$el.data("simplebar-direction")||this.$el.hasClass("simplebar horizontal"))&&(this.scrollDirection="horiz",this.scrollOffsetAttr="scrollLeft",this.sizeAttr="width",this.scrollSizeAttr="scrollWidth",this.offsetAttr="left"),this.options.wrapContent&&this.$el.wrapInner('<div class="simplebar-scroll-content"><div class="simplebar-content"></div></div>'),this.$contentEl=this.$el.find(".simplebar-content"),this.$el.prepend('<div class="simplebar-track"><div class="simplebar-scrollbar"></div></div>'),this.$track=this.$el.find(".simplebar-track"),this.$scrollbar=this.$el.find(".simplebar-scrollbar"),this.$scrollContentEl=this.$el.find(".simplebar-scroll-content"),this.resizeScrollContent(),this.options.autoHide&&this.$el.on("mouseenter",$.proxy(this.flashScrollbar,this)),this.$scrollbar.on("mousedown",$.proxy(this.startDrag,this)),this.$scrollContentEl.on("scroll",$.proxy(this.startScroll,this)),this.resizeScrollbar(),void(this.options.autoHide||this.showScrollbar()))},SimpleBar.prototype.startDrag=function(e){e.preventDefault();var eventOffset=e.pageY;"horiz"===this.scrollDirection&&(eventOffset=e.pageX),this.dragOffset=eventOffset-this.$scrollbar.offset()[this.offsetAttr],$(document).on("mousemove",$.proxy(this.drag,this)),$(document).on("mouseup",$.proxy(this.endDrag,this))},SimpleBar.prototype.drag=function(e){e.preventDefault();var eventOffset=e.pageY,dragPos=null,dragPerc=null,scrollPos=null;"horiz"===this.scrollDirection&&(eventOffset=e.pageX),dragPos=eventOffset-this.$track.offset()[this.offsetAttr]-this.dragOffset,dragPerc=dragPos/this.$track[this.sizeAttr](),scrollPos=dragPerc*this.$contentEl[0][this.scrollSizeAttr],this.$scrollContentEl[this.scrollOffsetAttr](scrollPos)},SimpleBar.prototype.endDrag=function(){$(document).off("mousemove",this.drag),$(document).off("mouseup",this.endDrag)},SimpleBar.prototype.resizeScrollbar=function(){if(0!==SCROLLBAR_WIDTH){var contentSize=this.$contentEl[0][this.scrollSizeAttr],scrollOffset=this.$scrollContentEl[this.scrollOffsetAttr](),scrollbarSize=this.$track[this.sizeAttr](),scrollbarRatio=scrollbarSize/contentSize,handleOffset=Math.round(scrollbarRatio*scrollOffset)+2,handleSize=Math.floor(scrollbarRatio*(scrollbarSize-2))-2;scrollbarSize<contentSize?("vert"===this.scrollDirection?this.$scrollbar.css({top:handleOffset,height:handleSize}):this.$scrollbar.css({left:handleOffset,width:handleSize}),this.$track.show()):this.$track.hide()}},SimpleBar.prototype.startScroll=function(e){this.$el.trigger(e),this.flashScrollbar()},SimpleBar.prototype.flashScrollbar=function(){this.resizeScrollbar(),this.showScrollbar()},SimpleBar.prototype.showScrollbar=function(){this.$scrollbar.addClass("visible"),this.options.autoHide&&("number"==typeof this.flashTimeout&&window.clearTimeout(this.flashTimeout),this.flashTimeout=window.setTimeout($.proxy(this.hideScrollbar,this),1e3))},SimpleBar.prototype.hideScrollbar=function(){this.$scrollbar.removeClass("visible"),"number"==typeof this.flashTimeout&&window.clearTimeout(this.flashTimeout)},SimpleBar.prototype.resizeScrollContent=function(){var is_firefox=/firefox/i.test(navigator.userAgent);is_firefox&&("vert"===this.scrollDirection?(this.$scrollContentEl.width(this.$el.width()+SCROLLBAR_WIDTH),this.$scrollContentEl.height(this.$el.height())):(this.$scrollContentEl.width(this.$el.width()),this.$scrollContentEl.height(this.$el.height()+SCROLLBAR_WIDTH)))},SimpleBar.prototype.recalculate=function(){this.resizeScrollContent(),this.resizeScrollbar()},SimpleBar.prototype.getScrollElement=function(){return this.$scrollContentEl},SimpleBar.prototype.getContentElement=function(){return this.$contentEl},$(window).on("load",function(){$("[data-simplebar-direction]").each(function(){$(this).simplebar()})});var old=$.fn.simplebar;$.fn.simplebar=function(options){var returns,args=arguments;return"undefined"==typeof options||"object"==typeof options?this.each(function(){$.data(this,"simplebar")||$.data(this,"simplebar",new SimpleBar(this,options))}):"string"==typeof options?(this.each(function(){var instance=$.data(this,"simplebar");instance instanceof SimpleBar&&"function"==typeof instance[options]&&(returns=instance[options].apply(instance,Array.prototype.slice.call(args,1))),"destroy"===options&&$.data(this,"simplebar",null)}),returns!==undefined?returns:this):void 0},$.fn.simplebar.Constructor=SimpleBar,$.fn.simplebar.noConflict=function(){return $.fn.simplebar=old,this}});